<div class="container-fluid py-4 payroll-page">

  <div class="d-flex justify-content-between align-items-center mb-4">
    <h3 class="fw-bold mb-0">Payroll Management</h3>
    <span class="text-muted small">Manage monthly payroll efficiently</span>
  </div>

  <!-- Filter Card -->
  <div class="card border-0 shadow-sm rounded-4 mb-4 filter-card">
    <div class="card-body">
      <form [formGroup]="filterForm" class="row g-4 align-items-end">

        <div class="col-md-3">
          <label class="form-label fw-semibold">Year</label>
          <input type="number" class="form-control form-control-lg rounded-3" formControlName="year">
        </div>

        <div class="col-md-3">
          <label class="form-label fw-semibold">Month</label>
          <select class="form-select form-select-lg rounded-3" formControlName="month">
            <option *ngFor="let m of [1,2,3,4,5,6,7,8,9,10,11,12]" [value]="m">
              {{ m }}
            </option>
          </select>
        </div>

        <div class="col-md-3">
          <button type="button" class="btn btn-primary btn-lg w-100 rounded-3 fw-semibold" (click)="loadPayroll()">
            Load Payroll
          </button>
        </div>

      </form>
    </div>
  </div>

  <!-- Loader -->
  <div *ngIf="loading" class="text-center py-5">
    <div class="spinner-border text-primary"></div>
  </div>

  <!-- Payroll Table -->
  <div *ngIf="payrollList.length > 0" class="card border-0 shadow-sm rounded-4">

    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table align-middle mb-0 payroll-table">

          <thead>
            <tr>
              <th>Name</th>
              <th>Designation</th>
              <th>Status</th>
              <th class="text-end">Gross</th>
              <th class="text-end">Net</th>
              <th class="text-center">Actions</th>
            </tr>
          </thead>

          <tbody>
            <tr *ngFor="let p of payrollList">

              <td class="fw-semibold">{{ p.employeeName }}</td>
              <td class="text-muted">{{ p.designation }}</td>

              <td>
                <span class="badge px-3 py-2 rounded-pill" [ngClass]="{
                        'bg-success-subtle text-success': p.payrollGenerated,
                        'bg-secondary-subtle text-secondary': !p.payrollGenerated
                      }">
                  {{ p.status }}
                </span>
              </td>

              <td class="text-end fw-semibold">
                {{ p.grossSalary ? (p.grossSalary | currency:'INR') : '-' }}
              </td>

              <td class="text-end fw-bold text-primary">
                {{ p.netSalary ? (p.netSalary | currency:'INR') : '-' }}
              </td>

              <td class="text-center">

                <button *ngIf="!p.payrollGenerated" class="btn btn-outline-warning btn-sm rounded-3 me-2 px-3"
                  (click)="generatePayroll(p.employeeId)">
                  Generate
                </button>

                <button *ngIf="p.payrollGenerated" class="btn btn-success btn-sm rounded-3 px-3"
                  (click)="downloadPayroll(p.employeeId)">
                  Download
                </button>

              </td>

            </tr>
          </tbody>

        </table>
      </div>
    </div>

  </div>

</div>